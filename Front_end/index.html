<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mosqu√©e des Bienfaisants</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  
  <!-- ========== HEADER / NAVBAR ========== -->
  <header class="navbar">
    <div class="container">
      <div class="navbar-content">
        <a href="#home" class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>
          <span>Mosqu√©e des Bienfaisants</span>
        </a>

        <nav class="nav-links">
          <a href="#home" class="active">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/></svg>
            Accueil
          </a>
          <a href="inscription.html" id="nav-inscription">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" x2="19" y1="8" y2="14"/><line x1="22" x2="16" y1="11" y2="11"/></svg>
            S'inscrire
          </a>
          <a href="#contact">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            Contact Imam
          </a>
          <a href="#evenements">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
            √âv√©nements
          </a>
          <a href="#times">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            Horaires
          </a>
        </nav>
      </div>
    </div>
  </header>

  <!-- ========== HERO SECTION ========== -->
  <section id="home" class="hero-section">
    <div class="hero-background">
      <img src="https://images.unsplash.com/photo-1564769625905-50e93615e769?q=80&w=2000" alt="Int√©rieur de mosqu√©e" onerror="this.src='https://images.unsplash.com/photo-1591604129939-f1efa4d9f7fa?q=80&w=2000'">
      <div class="hero-overlay"></div>
    </div>
    
    <div class="hero-content">
      <h1>Bienvenue √† la Mosqu√©e des Bienfaisants</h1>
      <p>
        Un lieu de paix, de pri√®re et de communaut√© au c≈ìur de P√©rigueux.<br>
        Rejoignez-nous pour les pri√®res quotidiennes, les √©v√©nements communautaires et les moments de spiritualit√© partag√©e.
      </p>
      <div class="hero-buttons">
        <button class="hero-btn-primary" onclick="document.getElementById('contact').scrollIntoView({behavior: 'smooth'})">
          Contacter l'Imam
        </button>
        <button class="hero-btn-secondary" onclick="document.getElementById('evenements').scrollIntoView({behavior: 'smooth'})">
          Voir les √âv√©nements
        </button>
      </div>
    </div>
  </section>

  <!-- ========== HORAIRES DE PRI√àRES ========== -->
  <section id="times">
    <div class="container">
      <div class="section-header">
        <svg class="section-icon" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        <h2>Horaires des Pri√®res</h2>
        <p>Consultez les horaires des cinq pri√®res quotidiennes. Les heures peuvent varier l√©g√®rement selon la saison.</p>
      </div>

      <!-- Card Prochaine Pri√®re -->
      <div class="next-prayer-card" id="next-prayer-card">
        <div class="next-prayer-label">Prochaine Pri√®re</div>
        <div class="next-prayer-name" id="next-prayer-name">Asr</div>
        <div class="next-prayer-time" id="next-prayer-time">dans 1h 25m</div>
        <div class="current-prayer-info">Pri√®re actuelle: <span id="current-prayer-name">Dhuhr</span></div>
      </div>

      <!-- Grille des pri√®res -->
      <ul id="prayer-times"></ul>
    </div>
  </section>

  <!-- ========== FOOTER ========== -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-col">
        <h3>√Ä propos</h3>
        <p>La Mosqu√©e des Bienfaisants est un lieu de culte, d'apprentissage et de partage au service de la communaut√© musulmane de P√©rigueux.</p>
      </div>
      <div class="footer-col">
        <h3>Liens utiles</h3>
        <ul>
          <li><a href="#home">Accueil</a></li>
          <li><a href="#times">Horaires</a></li>
          <li><a href="#contact">Contact</a></li>
          <li><a href="#evenements">√âv√©nements</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h3>Contact</h3>
        <p>123 Rue de la Mosqu√©e<br>24000 P√©rigueux, France</p>
        <p>T√©l: +33 5 53 45 67 89<br>Email: contact@mosquee-bienfaisants.fr</p>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Mosqu√©e des Bienfaisants. Tous droits r√©serv√©s.</p>
    </div>
  </footer>

  <!-- ========== SCRIPTS ========== -->
  <script>
    // ===== API HORAIRES DE PRI√àRES =====
    const URL = "https://api.aladhan.com/v1/timingsByCity?city=Perigueux&country=France&method=99&customFajr=12&customIsha=12&school=1&latitudeAdjustmentMethod=MIDDLE_OF_THE_NIGHT&adjustment=0&tune=0,0,0,0,0,0";
    const IQAMA = { Fajr: 10, Dhuhr: 10, Asr: 10, Maghrib: 10, Isha: 10 };
    const META = {
      Fajr:    { icon: "üåÖ", desc: "Pri√®re de l'aube" },
      Dhuhr:   { icon: "‚òÄÔ∏è", desc: "Pri√®re du midi" },
      Asr:     { icon: "üå§Ô∏è", desc: "Pri√®re de l'apr√®s-midi" },
      Maghrib: { icon: "üåá", desc: "Pri√®re du coucher du soleil" },
      Isha:    { icon: "üåô", desc: "Pri√®re de la nuit" }
    };
    const ORDER = ["Fajr","Dhuhr","Asr","Maghrib","Isha"];

    const parseHM = (s) => { const [h,m]=s.split(":").map(Number); const d=new Date(); d.setHours(h,m,0,0); return d; };
    const addMin  = (d,m) => new Date(d.getTime()+m*60000);
    const fmt     = (d)   => String(d.getHours()).padStart(2,"0")+":"+String(d.getMinutes()).padStart(2,"0");

    function currentPrayer(t) {
      const now = new Date();
      for (let i=0; i<ORDER.length; i++) {
        const curr = parseHM(t[ORDER[i]]);
        const next = ORDER[i+1] ? parseHM(t[ORDER[i+1]]) : addMin(parseHM(t["Fajr"]), 24*60);
        if (now >= curr && now < next) return ORDER[i];
      }
      return "Isha";
    }

    function getNextPrayer(t) {
      const now = new Date();
      const currentTime = now.getHours() * 60 + now.getMinutes();
      
      const times = ORDER.map(name => ({
        name,
        minutes: parseHM(t[name]).getHours() * 60 + parseHM(t[name]).getMinutes()
      }));

      for (let prayer of times) {
        if (currentTime < prayer.minutes) {
          const diff = prayer.minutes - currentTime;
          const hours = Math.floor(diff / 60);
          const minutes = diff % 60;
          return {
            name: prayer.name,
            timeUntil: `${hours}h ${minutes}m`
          };
        }
      }

      const firstPrayer = times[0];
      const diff = (24 * 60) + firstPrayer.minutes - currentTime;
      const hours = Math.floor(diff / 60);
      const minutes = diff % 60;
      return {
        name: firstPrayer.name,
        timeUntil: `${hours}h ${minutes}m`
      };
    }

    fetch(URL)
      .then(r => { if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); })
      .then(({ data }) => {
        const t = data.timings;
        const current = currentPrayer(t);
        const next = getNextPrayer(t);

        document.getElementById('next-prayer-name').textContent = next.name;
        document.getElementById('next-prayer-time').textContent = `dans ${next.timeUntil}`;
        document.getElementById('current-prayer-name').textContent = current;

        const html = ORDER.map(key => {
          const adhanStr = t[key];
          const iqamaStr = fmt(addMin(parseHM(adhanStr), IQAMA[key] || 0));
          const { icon, desc } = META[key];

          return `
            <li class="${key===next.name ? 'active' : ''}">
              <div class="prayer-icon">${icon}</div>
              <div class="prayer-name">${key}</div>
              <div class="prayer-adhan"><small>Adhan:</small> ${adhanStr}</div>
              <div class="prayer-iqama">Iqama: +${IQAMA[key]||0}</div>
              <div class="prayer-desc">${desc}</div>
            </li>
          `;
        }).join("");

        document.getElementById("prayer-times").innerHTML = html;
      })
      .catch(err => {
        console.error(err);
        document.getElementById("prayer-times").innerHTML =
          `<li style="color:red;border:0;box-shadow:none;">Impossible de charger les horaires.</li>`;
      });

    // ===== NAVIGATION SMOOTH SCROLL =====
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });

    // ===== MASQUER S'INSCRIRE SI CONNECT√â =====
    document.addEventListener('DOMContentLoaded', function() {
      const isLoggedIn = localStorage.getItem('token') !== null;
      const inscriptionLink = document.getElementById('nav-inscription');
      
      if (isLoggedIn && inscriptionLink) {
        inscriptionLink.style.display = 'none';
      }
    });
  </script>

  <!--Start of Tawk.to Script-->
  <script type="text/javascript">
  var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
  (function(){
  var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
  s1.async=true;
  s1.src='https://embed.tawk.to/68ee9823ab07261951f59f2d/1j7i04j9u';
  s1.charset='UTF-8';
  s1.setAttribute('crossorigin','*');
  s0.parentNode.insertBefore(s1,s0);
  })();
  </script>
  <!--End of Tawk.to Script-->

</body>
</html>