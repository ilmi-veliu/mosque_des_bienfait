<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mosqu√©e des Bienfaisants</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Navbar automatique -->
  <div id="navbar-container"></div>

  <!-- Section Bienvenue -->
  <section class="Bienvenue">
    <h1>Bienvenue √† la Mosqu√©e des Bienfaisants</h1>
    <p> 
      Bienvenue √† la Mosqu√©e des Bienfaisants.<br>
      Un lieu de paix, de pri√®re et de communaut√© au c≈ìur de P√©rigueux.<br>
      Rejoignez-nous pour les pri√®res quotidiennes, les √©v√©nements communautaires et les moments de spiritualit√© partag√©e.
    </p>
  </section>

  <!-- Services -->
  <section class="services">
    <h2>Contactez l'imam</h2>
    <h2>Voir les √©v√©nements</h2>
  </section>

  <!-- Horaires de pri√®res (API) -->
  <section id="times">
    <h3>Horaires aujourd'hui ‚Äì P√©rigueux</h3>
    <ul id="prayer-times"></ul>
  </section>

  <!-- Footer automatique -->
  <div id="footer-container"></div>

  <!-- Scripts -->
  <script src="navbar.js"></script>
  <script src="footer.js"></script>
  
  <!-- Script API Horaires -->
  <script>
    const URL = "https://api.aladhan.com/v1/timingsByCity?city=Perigueux&country=France&method=99&customFajr=12&customIsha=12&school=1&latitudeAdjustmentMethod=MIDDLE_OF_THE_NIGHT&adjustment=0&tune=0,0,0,0,0,0";
  
    // offsets Iqama (min) ‚Äî ajuste si besoin
    const IQAMA = { Fajr: 10, Dhuhr: 10, Asr: 10, Maghrib: 10, Isha: 10 };
  
    // ic√¥nes + descriptions
    const META = {
      Fajr:    { icon: "üåÖ", desc: "Pri√®re de l'aube" },
      Dhuhr:   { icon: "‚òÄÔ∏è", desc: "Pri√®re du midi" },
      Asr:     { icon: "üå§Ô∏è", desc: "Pri√®re de l'apr√®s-midi" },
      Maghrib: { icon: "üåá", desc: "Pri√®re du coucher du soleil" },
      Isha:    { icon: "üåô", desc: "Pri√®re de la nuit" }
    };
  
    const ORDER = ["Fajr","Dhuhr","Asr","Maghrib","Isha"]; // pour calcul "courant"
  
    // helpers temps
    const parseHM = (s) => { const [h,m]=s.split(":").map(Number); const d=new Date(); d.setHours(h,m,0,0); return d; };
    const addMin  = (d,m) => new Date(d.getTime()+m*60000);
    const fmt     = (d)   => String(d.getHours()).padStart(2,"0")+":"+String(d.getMinutes()).padStart(2,"0");
  
    function currentPrayer(t) {
      const now = new Date();
      for (let i=0; i<ORDER.length; i++) {
        const curr = parseHM(t[ORDER[i]]);
        const next = ORDER[i+1] ? parseHM(t[ORDER[i+1]]) : addMin(parseHM(t["Fajr"]), 24*60);
        if (now >= curr && now < next) return ORDER[i];
      }
      return "Isha";
    }
  
    fetch(URL)
      .then(r => { if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); })
      .then(({ data }) => {
        const t = data.timings;
        const current = currentPrayer(t);
  
        // Construire les 5 cartes
        const html = ORDER.map(key => {
          const adhanStr = t[key];                    // "13:15"
          const iqamaStr = fmt(addMin(parseHM(adhanStr), IQAMA[key] || 0));
          const { icon, desc } = META[key];
  
          return `
            <li class="${key===current ? 'active' : ''}">
              <div class="prayer-icon">${icon}</div>
              <div class="prayer-name">${key}</div>
  
              <div class="prayer-adhan"><small>Adhan:</small> ${adhanStr}</div>
              <div class="prayer-iqama">Iqama: +${IQAMA[key]||0}</div>
  
              <div class="prayer-desc">${desc}</div>
            </li>
          `;
        }).join("");
  
        document.getElementById("prayer-times").innerHTML = html;
      })
      .catch(err => {
        console.error(err);
        document.getElementById("prayer-times").innerHTML =
          `<li style="color:red;border:0;box-shadow:none;">Impossible de charger les horaires.</li>`;
      });
  </script>
</body>
</html>