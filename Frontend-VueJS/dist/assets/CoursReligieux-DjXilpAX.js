import{c as F,r as l,a as I,o as O,q as H,b as a,d as i,e as o,f as d,w as Q,g as Y,u as f,h as Z,i as C,v as G,x as q,F as L,l as T,k as c,t as n,s as M,y as K,z as S,C as W}from"./index-DFNxEs4S.js";import{C as X}from"./chevron-left-Daamktqa.js";import{S as ee}from"./search-0KCnwv06.js";import{U as te}from"./user-C6jby3Sh.js";import{M as se}from"./map-pin-Bnzmezz-.js";/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=F("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),re={class:"bg-[#030213] text-white py-24 px-4 text-center"},ae={class:"max-w-7xl mx-auto"},ie={class:"bg-white py-10 px-4 border-b border-gray-200"},ne={class:"max-w-6xl mx-auto flex flex-col sm:flex-row flex-wrap gap-4 sm:gap-5 items-stretch sm:items-center"},le={class:"flex-1 min-w-0 sm:min-w-[300px] relative"},ue=["value"],de=["value"],ce={class:"py-16 px-4"},pe={class:"max-w-6xl mx-auto"},ve={key:0,class:"text-center py-20"},me={key:1,class:"text-center py-20"},fe={class:"text-red-600"},ge={key:2,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-8"},xe={class:"relative"},_e={key:0,class:"aspect-video"},ye=["src"],he=["src","alt"],be={key:2,class:"absolute top-4 left-4 bg-[#030213] text-white px-4 py-1.5 rounded-full text-xs font-semibold"},we={class:"p-6"},ke={class:"text-xl font-semibold text-gray-900 mb-3"},Ce={class:"text-gray-600 text-sm leading-relaxed mb-5"},Le={class:"space-y-2.5"},Te={key:0,class:"flex items-center gap-2.5 text-sm text-gray-700"},Me={key:1,class:"flex items-center gap-2.5 text-sm text-gray-700"},Se={key:2,class:"flex items-center gap-2.5 text-sm text-gray-700"},ze={key:0,class:"mt-4 pt-4 border-t border-gray-100"},Ve=["onClick"],Ae={class:"text-xs text-emerald-600 font-medium"},Ue=["src","onLoadedmetadata","onTimeupdate","onPause"],$e={key:3,class:"text-center py-20"},De={__name:"CoursReligieux",setup(qe){const g=l(""),x=l(""),_=l(""),y=l([]),h=l(!0),b=l(null),P=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],R=["Tajwid","Croyance","Jurisprudence","Langue arabe","Coran","Hadith","Sira","Éducation islamique"],p=l(null),u=l({}),v=l({});let k=null;const w=t=>{var e;return((e=u.value[t])==null?void 0:e.audio_position)||0},z=t=>{var e;return((e=u.value[t])==null?void 0:e.video_position)||0},j=t=>{const e=Math.floor(t/60),r=Math.floor(t%60);return`${e}:${r.toString().padStart(2,"0")}`},N=t=>{const e=v.value[t],r=w(t);e&&r>0&&(e.currentTime=r)},B=t=>{const e=v.value[t];if(!e)return;const r=w(t);r>0&&(e.currentTime=r),e.play()},D=t=>{if(!p.value)return;const e=v.value[t];e&&(u.value[t]||(u.value[t]={}),u.value[t].audio_position=e.currentTime)},V=async t=>{if(!p.value)return;const e=u.value[t];e&&await S.from("user_progress").upsert({user_id:p.value,cours_id:t,audio_position:e.audio_position||0,video_position:e.video_position||0,updated_at:new Date().toISOString()},{onConflict:"user_id,cours_id"})},A=async()=>{if(p.value)for(const t of Object.keys(v.value)){const e=v.value[t];e&&e.currentTime>0&&await V(t)}},J=async()=>{const{data:{session:t}}=await S.auth.getSession();if(!t)return;p.value=t.user.id;const{data:e}=await S.from("user_progress").select("*").eq("user_id",t.user.id);if(e)for(const r of e)u.value[r.cours_id]={audio_position:r.audio_position,video_position:r.video_position}},U=I(()=>{let t=y.value;if(g.value){const e=g.value.toLowerCase();t=t.filter(r=>r.titre.toLowerCase().includes(e)||r.description&&r.description.toLowerCase().includes(e)||r.enseignant&&r.enseignant.toLowerCase().includes(e))}return x.value&&(t=t.filter(e=>e.categorie===x.value)),_.value&&(t=t.filter(e=>e.jour===_.value)),t}),$=t=>{if(!t)return null;const e=t.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return e?e[1]:null},E=async()=>{try{M.cours.length>0&&(y.value=M.cours,h.value=!1),await K(!0),y.value=M.cours}catch(t){console.error("Erreur:",t),y.value.length===0&&(b.value="Impossible de charger les cours.")}finally{h.value=!1}};return O(async()=>{const t=E();J(),await t,k=setInterval(A,3e4)}),H(()=>{k&&clearInterval(k),A()}),(t,e)=>{const r=Z("router-link");return i(),a("div",null,[o("section",re,[o("div",ae,[d(r,{to:"/",class:"inline-flex items-center gap-2 text-white mb-8 hover:opacity-80 transition-opacity"},{default:Q(()=>[d(f(X),{size:20}),e[3]||(e[3]=Y(" Retour à l'accueil ",-1))]),_:1}),e[4]||(e[4]=o("h1",{class:"text-4xl md:text-5xl font-semibold mb-5"},"Cours Religieux",-1)),e[5]||(e[5]=o("p",{class:"max-w-3xl mx-auto text-lg leading-relaxed opacity-90"}," Approfondissez vos connaissances religieuses avec nos cours dispensés à la mosquée. ",-1))])]),o("section",ie,[o("div",ne,[o("div",le,[d(f(ee),{class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),C(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),type:"text",placeholder:"Rechercher un cours...",class:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-gray-900 transition-colors"},null,512),[[G,g.value]])]),C(o("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),class:"px-5 py-3 border border-gray-300 rounded-xl bg-white focus:outline-none focus:border-gray-900 transition-colors"},[e[6]||(e[6]=o("option",{value:""},"Toutes les catégories",-1)),(i(),a(L,null,T(R,s=>o("option",{key:s,value:s},n(s),9,ue)),64))],512),[[q,x.value]]),C(o("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),class:"px-5 py-3 border border-gray-300 rounded-xl bg-white focus:outline-none focus:border-gray-900 transition-colors"},[e[7]||(e[7]=o("option",{value:""},"Tous les jours",-1)),(i(),a(L,null,T(P,s=>o("option",{key:s,value:s},n(s),9,de)),64))],512),[[q,_.value]])])]),o("section",ce,[o("div",pe,[e[10]||(e[10]=o("h2",{class:"text-3xl font-semibold text-gray-900 mb-10"},"Nos Cours",-1)),h.value?(i(),a("div",ve,[...e[8]||(e[8]=[o("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-gray-900"},null,-1),o("p",{class:"mt-4 text-gray-600"},"Chargement des cours...",-1)])])):b.value?(i(),a("div",me,[o("p",fe,n(b.value),1)])):(i(),a("div",ge,[(i(!0),a(L,null,T(U.value,s=>(i(),a("div",{key:s.id,class:"bg-white rounded-2xl overflow-hidden shadow-md hover:-translate-y-2 hover:shadow-xl transition-all"},[o("div",xe,[s.video_url&&$(s.video_url)?(i(),a("div",_e,[o("iframe",{src:`https://www.youtube.com/embed/${$(s.video_url)}${z(s.id)?"?start="+Math.floor(z(s.id)):""}`,class:"w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ye)])):(i(),a("img",{key:1,src:s.image_url||"https://images.unsplash.com/photo-1585036156171-384164a8c159?q=80&w=800",alt:s.titre,class:"w-full h-56 object-cover"},null,8,he)),s.categorie?(i(),a("span",be,n(s.categorie),1)):c("",!0)]),o("div",we,[o("h3",ke,n(s.titre),1),o("p",Ce,n(s.description),1),o("div",Le,[s.enseignant?(i(),a("div",Te,[d(f(te),{size:18,class:"text-gray-400"}),o("span",null,n(s.enseignant),1)])):c("",!0),s.jour?(i(),a("div",Me,[d(f(W),{size:18,class:"text-gray-400"}),o("span",null,n(s.jour)+n(s.heure?" à "+s.heure.substring(0,5):""),1)])):c("",!0),s.lieu?(i(),a("div",Se,[d(f(se),{size:18,class:"text-gray-400"}),o("span",null,n(s.lieu),1)])):c("",!0)]),s.audio_url?(i(),a("div",ze,[p.value&&w(s.id)>0?(i(),a("button",{key:0,onClick:m=>B(s.id),class:"flex items-center gap-2 mb-2 hover:opacity-70 transition-opacity cursor-pointer"},[d(f(oe),{size:14,class:"text-emerald-600"}),o("span",Ae,"Reprendre à "+n(j(w(s.id))),1)],8,Ve)):c("",!0),o("audio",{ref_for:!0,ref:m=>{m&&(v.value[s.id]=m)},src:s.audio_url,controls:"",class:"w-full rounded-lg",onLoadedmetadata:m=>N(s.id),onTimeupdate:m=>D(s.id),onPause:m=>V(s.id)},null,40,Ue)])):c("",!0)])]))),128))])),!h.value&&!b.value&&U.value.length===0?(i(),a("div",$e,[...e[9]||(e[9]=[o("p",{class:"text-gray-600"},"Aucun cours trouvé.",-1)])])):c("",!0)])])])}}};export{De as default};
